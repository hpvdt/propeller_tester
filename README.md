# Propeller Test Rig
Used by HPVDT to determine the power output of propellers for aircraft. 

## System Design
The primary purpose of this system is to determine the thrust generated by a propeller given an input power. It then must inform the user of the values. It was designed around an embedded Arduino Nano, and is programmed/operated using the Arduino IDE.

### Collecting data
To detemine the input power the shaft work for the drive shaft is needed. This is determined as the product of rotational speed and torque. The shaft has two optical encoders located at each end, these are used to monitor the rotational speed and the lag between the two encoders readings. This phase is used to derive the deformation of the shaft which in turn allows the derivation of the torque applied to it.

To determine the thrust generated by the propeller it is mounted to a mobile platform with the rest of the system that is anchored through a loadcell. The tension through this anchor is detected by the loadcell and is used to determine the thrust the propeller is generating.

### Outputting data
The system was originally intended to inform the user of the data through built in seven-segment displays for each field. However this code primarily functions by outputting the data over serial (USB) connection to a computer.

## Installation
The only installation required on the client's computer is to add the NAU7802 library in this repository to their Arduino library folder. This is generally located in their sketchbook as a folder called "library".

## Calibration
The system stores configuration parameters internally on the microcontroller's EEPROM. This allows the system to be easily recalibrated by simply by following the prepared programs, which do not require the user to alter any code themselves (e.g. constants in headers). These will providse the user with instructions through the terminal window, **sending messages at a baud rate of 9600**.

* The loadcell is calibrated using `Example2...` from the NAU7802 library provided in this repository.
* The encoders are calibrated using the provided `phase_calibration` sketch in this repository.

## Operation
Once the system is properly calibrated as per the previous section, the system is operated by uploading the `propeller_tester` sketch. It will read in the calibration data stored in EEPROM and run without user intervention. **It will broadcast information over serial at a baudrate of 115200**. *NOTE: It is recommended that the system be powered on before the propeller starts spinning.*

## TODO
- [ ] Test all the code in the final assembly
